NdH Lenstra Challenge
=====================

Origin
------

> https://infoscience.epfl.ch/record/164524/files/nscan20.PDF

To optimize RSA signature, modern algorithms use the Chinese Remaining Theorem (CRT) to split the exponential computation.
This can easily be exploited to find p or q if one error is introduced during the algorithm.
Read the paper for more information on that subject!

Vulnerability
-------------

Go, from its 1.5 version to 1.5.2, had a bug in its CRT, occuring very rarely, and allowing one to leak p or q when signing messages.
See CVE-2015-8618.

This challenge provides some signatures generated by Go 1.5.1, along with an encrypted message built this very same key.
One of the provided signature is made to be erroneous, and subject to the Lenstra attack ("Pic Sans Nom").
To build this vulnerable signature, we explicitly aggravated the Go vulnerable code.

Usage
-----

To build the challenge, run the provided vulnerable binary with the flag as the only argument.
The challenge will be sent to stdout.
You can check that the challenge is solvable by checking the stderr (the solution is executed in parallel).
For debug purposes, the secret key will be generated in the current folder. DO NOT LEAK IT.

```
$ ./lenstra THE_FLAG > challenge.txt
```

Misc
----

To solve this challenge, one must avoid several traps:

* Do not forget to apply the PKCS1v15 padding before trying to find p and q ;
* The flag might be hidden in some random padding, check everything with care.
